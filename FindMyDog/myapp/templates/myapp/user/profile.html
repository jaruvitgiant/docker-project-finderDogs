{% extends "base.html" %}

{% block title %}{{ profile_title }}{% endblock %}

{% block content %}
<div class="max-w-3xl mx-auto p-4 sm:p-6 lg:p-8">
    
    <header class="text-center mb-10">
        <h1 class="text-4xl font-extrabold text-gray-800 dark:text-white">
            <span class="inline-block align-middle mr-3">
                <i class="fas fa-user-circle"></i>
            </span>
            {{ profile_title }}
        </h1>
        <p class="text-lg text-gray-600 dark:text-gray-400 mt-2">รายละเอียดบัญชีผู้ใช้งาน</p>
    </header>

    <div class="card bg-white shadow-2xl rounded-xl border border-gray-100 p-8">
        
        <div class="flex flex-col items-center pb-10 border-b border-gray-200 mb-6">
            <div class="avatar placeholder mb-4">
                <div class="bg-indigo-100 text-indigo-700 rounded-full w-24">
                    <span class="text-3xl font-bold">{{ user.username.0|upper }}</span>
                </div>
            </div>
            
            <h2 class="text-3xl font-bold text-gray-900">{{ user.username }}</h2>
            <p class="text-gray-500 mt-1">{{ user.email }}</p>
        </div>
        
        {% if is_edit_mode %}
        <form method="POST" action="{% url 'user_profile' %}?edit=true">
            {% csrf_token %}
        {% endif %}

        <div class="space-y-4">
            
            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-lg shadow-sm">
                <span class="font-semibold text-gray-700">ชื่อผู้ใช้งาน (Username)</span>
                <span class="text-lg font-mono text-indigo-600">{{ user.username }}</span>
            </div>
            
            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-lg shadow-sm">
                <span class="font-semibold text-gray-700">อีเมล (Email)</span>
                <span class="text-lg text-gray-800">{{ user.email }}</span>
            </div>

            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-lg shadow-sm">
                <span class="font-semibold text-gray-700">เบอร์โทรศัพท์</span>
                {% if is_edit_mode %}
                    <input type="tel" name="phone" value="{{ user.phone|default:'' }}" class="input input-bordered w-full max-w-xs" placeholder="เบอร์โทรศัพท์" required />
                {% else %}
                    <span class="text-lg text-gray-800">{{ user.phone|default:"-" }}</span>
                {% endif %}
            </div>

            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-lg shadow-sm">
                <span class="font-semibold text-gray-700">Line ID</span>
                {% if is_edit_mode %}
                    <input type="text" name="line_id" value="{{ user.line_id|default:'' }}" class="input input-bordered w-full max-w-xs" placeholder="Line ID" />
                {% else %}
                    <span class="text-lg text-gray-800">{{ user.line_id|default:"-" }}</span>
                {% endif %}
            </div>
            
            <div class="flex justify-between items-center p-4 bg-indigo-50 rounded-lg shadow-md">
                <span class="font-semibold text-gray-700">บทบาท (Role)</span>
                <div class="badge badge-lg {% if user.role == 'org_admin' %}badge-primary{% else %}badge-info{% endif %} font-bold">
                    {{ user.get_role_display|default:user.role|upper }}
                </div>
            </div>

            <div class="flex justify-between items-center p-4 bg-gray-50 rounded-lg shadow-sm">
                <span class="font-semibold text-gray-700">วันที่เข้าร่วม</span>
                <span class="text-md text-gray-800">{{ user.date_joined|date:"d M Y" }}</span>
            </div>
            
        </div>

        <div class="mt-8 text-center space-x-2">
            {% if is_edit_mode %}
                <a href="{% url 'user_profile' %}" class="btn btn-outline btn-error">ยกเลิก</a>
                <button type="submit" class="btn btn-primary text-white">บันทึกการเปลี่ยนแปลง</button>
            {% else %}
                <a href="?edit=true" class="btn btn-outline btn-wide btn-primary">
                    แก้ไขข้อมูลส่วนตัว
                </a>
            {% endif %}
        </div>

        {% if is_edit_mode %}
        </form>
        {% endif %}
        
    </div>

</div>
{% endblock %}